{"version":3,"file":"index.js","sources":["node-modules:///vite/modulepreload-polyfill","source-maps:///App.vue","source-maps:///main.js"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","<template>\n  <label>\n    <input type=\"checkbox\" v-model=\"GZipped\"> GZipped\n  </label>\n\n  <hr>\n  <span class=\"receivedLength\">{{bytesToSizeWinLike(receivedLength)}}</span>\n  of\n  <span class=\"contentLength\">{{bytesToSizeWinLike(contentLength)}}</span>\n  <hr>\n  <span class=\"percent\">{{percent}} %</span> downloaded.\n  <hr>\n  <div class=\"warning\">{{warning}}</div>\n</template>\n\n<script setup>\nimport {ref, watchEffect} from \"vue\";\n\n\nconst GZipped = ref(true);\nconst receivedLength = ref(0);\nconst contentLength = ref(0);\nconst percent = ref(\"0\");\n\nconst warning = ref(\"\");\n\n\nwatchEffect(async () => {\n  receivedLength.value = 0;\n  contentLength.value = 0;\n  percent.value = \"0\";\n\n  const response = await fetch(\"./[.dir-scan] 2022.01.09.json\" + (GZipped.value ? \".gz\" : \"\"));\n  loadingProxyResponse({response, onProgress: (r, t) => {\n      onLoadingProgressHTML(r, t);\n      onLoadingProgressConsoleLog(r, t);\n    }});\n});\n\nwatchEffect(() => {\n  if (parseFloat(percent.value) > 100) {\n    warning.value = \"% is more than 100\";\n  } else  {\n    warning.value = \"\";\n  }\n});\n\n\nfunction onLoadingProgressHTML(_receivedLength, _contentLength) {\n  receivedLength.value = _receivedLength;\n  contentLength.value = _contentLength;\n  percent.value = (_receivedLength / _contentLength * 100 + \"\").substring(0, 5);\n}\n\n\nfunction bytesToSizeWinLike(bytes) {\n  if (bytes < 1024) { return bytes + \" B\"; }\n  const sizes = [\"B\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\"];\n  let i = Math.floor(Math.log(bytes) / Math.log(1024));\n  let result = bytes / Math.pow(1024, i);\n  if (result >= 1000) {\n    i++;\n    result /= 1024;\n  }\n  return toTruncPrecision3(result) + \" \" + sizes[i];\n}\nfunction toTruncPrecision3(number) {\n  let result;\n  if (number < 10) {\n    result = Math.trunc(number * 100) / 100;\n  } else if (number < 100) {\n    result = Math.trunc(number * 10) / 10;\n  } else if (number < 1000) {\n    result = Math.trunc(number);\n  }\n  if (number < 0.1) {\n    return result.toPrecision(1);\n  } else if (number < 1) {\n    return result.toPrecision(2);\n  }\n  return result.toPrecision(3);\n}\n\n\nfunction loadingProxyResponse({response, onProgress, contentLength, contentType}) {\n  if (!onProgress) {\n    return response;\n  }\n  contentLength = contentLength || parseInt(response.headers.get(\"Content-Length\"));\n  contentType = contentType || response.headers.get(\"Content-Type\");\n\n  console.log(\"Content-Length: \", contentLength);\n  if (isNaN(contentLength)) {\n    console.warn(\"Content-Length is NaN:\", contentLength);\n    return response;\n  }\n\n  let receivedLength = 0;\n  const reader = response.body.getReader();\n  const readableStream = new ReadableStream({\n    async start(controller) {\n      while (true) {\n        const {done, /** @type {Uint8Array} */ value} = await reader.read();\n        if (done) {\n          break;\n        }\n        receivedLength += value.length;\n        try {\n          onProgress(receivedLength, contentLength, value, contentType);\n        } catch (e) {\n          console.error(\"onProgress error:\", e);\n        }\n        controller.enqueue(value);\n      }\n      controller.close();\n      reader.releaseLock();\n    },\n    cancel() {\n      reader.cancel();\n    }\n  });\n\n  // https://developer.mozilla.org/en-US/docs/Web/API/Response/Response\n  // console.log(response);\n  return new Response(readableStream, {\n    status: response.status,\n    statusText: response.statusText,\n    headers: response.headers,\n  });\n}\n\nconst logDebouncer = getDebounce();\nfunction getDebounce() {\n  let cb;\n  let timer;\n  return function debounce(callback, reset = false) {\n    if (!cb || reset) {\n      callback();\n      cb = true;\n      clearTimeout(timer);\n      timer = null;\n      return;\n    }\n    cb = callback;\n    if (timer) {\n      return;\n    }\n    timer = setTimeout(() => {\n      cb();\n      timer = null;\n    }, 2000);\n  }\n}\nfunction onLoadingProgressConsoleLog(receivedLength, contentLength) {\n  if (!contentLength) {return;}\n  const percentage = receivedLength / contentLength;\n  const text = (percentage * 100 + \"\").substring(0, 4) + \" % of \" + bytesToSizeWinLike(contentLength);\n\n  const needReset = percentage === 1;\n  const callback = () => {\n    console.log(text);\n  };\n  logDebouncer(callback, needReset);\n}\n\n</script>\n\n<style>\n.warning {\n  color: red;\n}\n</style>\n","import { createApp } from 'vue'\nimport App from './App.vue'\n\ncreateApp(App).mount('#app')\n"],"names":["App"],"mappings":"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"}